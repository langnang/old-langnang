(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{620:function(e,r,n){"use strict";n.r(r);var t=n(18),a=Object(t.a)({},(function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"perf-hooks-性能钩子-node-js-api-文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#perf-hooks-性能钩子-node-js-api-文档"}},[e._v("#")]),e._v(" perf_hooks 性能钩子 | Node.js API 文档")]),e._v(" "),n("blockquote",[n("h2",{attrs:{id:"excerpt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#excerpt"}},[e._v("#")]),e._v(" Excerpt")]),e._v(" "),n("p",[e._v("中英对照")])]),e._v(" "),n("hr"),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_measurement_apis.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("strong",[e._v("源代码:")]),e._v(" "),n("a",{attrs:{href:"https://github.com/nodejs/node/blob/v12.22.12/lib/perf_hooks.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("lib/perf_hooks.js"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("此模块提供了 W3C "),n("a",{attrs:{href:"http://url.nodejs.cn/YVxQCq",target:"_blank",rel:"noopener noreferrer"}},[e._v("Web 性能 API"),n("OutboundLink")],1),e._v(" 子集的实现，以及用于 Node.js 特定性能测量的其他 API。")]),e._v(" "),n("p",[e._v("Node.js 支持以下的 "),n("a",{attrs:{href:"http://url.nodejs.cn/YVxQCq",target:"_blank",rel:"noopener noreferrer"}},[e._v("Web 性能 API"),n("OutboundLink")],1),e._v("：")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/ZNcM3v",target:"_blank",rel:"noopener noreferrer"}},[e._v("高解析度时间"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/ds56gw",target:"_blank",rel:"noopener noreferrer"}},[e._v("性能时间轴"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/j6SkJP",target:"_blank",rel:"noopener noreferrer"}},[e._v("用户计时"),n("OutboundLink")],1)])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const { PerformanceObserver, performance } = require('perf_hooks');\n\nconst obs = new PerformanceObserver((items) => {\n  console.log(items.getEntries()[0].duration);\n  performance.clearMarks();\n});\nobs.observe({ entryTypes: ['measure'] });\nperformance.measure('Start to Now');\n\nperformance.mark('A');\ndoSomeLongRunningProcess(() => {\n  performance.measure('A to Now', 'A');\n\n  performance.mark('B');\n  performance.measure('A to B', 'A', 'B');\n});\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br")])]),n("h3",{attrs:{id:"perf-hooks-performance"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#perf-hooks-performance"}},[e._v("#")]),e._v(" "),n("code",[e._v("perf_hooks.performance")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#perf_hooksperformance",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/perf_hooks_performance.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("p",[e._v("可用于从当前 Node.js 实例收集性能指标的对象。 类似于浏览器中的 "),n("a",{attrs:{href:"http://url.nodejs.cn/WnJqii",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("window.performance")]),n("OutboundLink")],1),e._v("。")]),e._v(" "),n("h4",{attrs:{id:"performance-clearmarks-name"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-clearmarks-name"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.clearMarks([name])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceclearmarksname",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_clearmarks_name.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("name")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("如果未提供 "),n("code",[e._v("name")]),e._v("，则从性能时间轴中删除所有 "),n("code",[e._v("PerformanceMark")]),e._v(" 对象。 如果提供了 "),n("code",[e._v("name")]),e._v("，则仅删除命名标记。")]),e._v(" "),n("h4",{attrs:{id:"performance-eventlooputilization-utilization1-utilization2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-eventlooputilization-utilization1-utilization2"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.eventLoopUtilization([utilization1[, utilization2]])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceeventlooputilizationutilization1-utilization2",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_eventlooputilization_utilization1_utilization2.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v14.10.0, v12.19.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("utilization1")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" 上一次调用 "),n("code",[e._v("eventLoopUtilization()")]),e._v(" 的结果。")]),e._v(" "),n("li",[n("code",[e._v("utilization2")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" 在 "),n("code",[e._v("utilization1")]),e._v(" 之前调用 "),n("code",[e._v("eventLoopUtilization()")]),e._v(" 的结果。")]),e._v(" "),n("li",[e._v("返回 "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" "),n("ul",[n("li",[n("code",[e._v("idle")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("active")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("utilization")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])])])]),e._v(" "),n("p",[n("code",[e._v("eventLoopUtilization()")]),e._v(" 方法返回包含事件循环作为高解析度毫秒计时器的既空闲又活动的累积持续时间的对象。 "),n("code",[e._v("utilization")]),e._v(" 值是计算的事件循环利用率 (ELU)。")]),e._v(" "),n("p",[e._v("如果主线程上的引导尚未完成，则属性的值为 "),n("code",[e._v("0")]),e._v("。 由于引导发生在事件循环内，所以 ELU 立即在"),n("a",{attrs:{href:"http://url.nodejs.cn/6jQc84",target:"_blank",rel:"noopener noreferrer"}},[e._v("工作线程"),n("OutboundLink")],1),e._v("上可用。")]),e._v(" "),n("p",[n("code",[e._v("utilization1")]),e._v(" 和 "),n("code",[e._v("utilization2")]),e._v(" 都是可选参数。")]),e._v(" "),n("p",[e._v("如果传入了 "),n("code",[e._v("utilization1")]),e._v("，则计算当前调用的 "),n("code",[e._v("active")]),e._v(" 和 "),n("code",[e._v("idle")]),e._v(" 之间的差值，以及对应的 "),n("code",[e._v("utilization")]),e._v(" 值(类似于 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/process.html#process_process_hrtime_time",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("process.hrtime()")]),n("OutboundLink")],1),e._v(")。")]),e._v(" "),n("p",[e._v("如果传入了 "),n("code",[e._v("utilization1")]),e._v(" 和 "),n("code",[e._v("utilization2")]),e._v("，则计算两个参数之间的增量。 这是便捷的选项，因为与 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/process.html#process_process_hrtime_time",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("process.hrtime()")]),n("OutboundLink")],1),e._v(" 不同，计算 ELU 比单个减法更复杂。")]),e._v(" "),n("p",[e._v("ELU 类似于 CPU 使用率，不同之处在于它只测量事件循环统计信息而不是 CPU 使用率。 它表示事件循环在事件循环的事件提供者（例如 "),n("code",[e._v("epoll_wait")]),e._v("）之外花费的时间百分比。 不考虑其他 CPU 空闲时间。 以下是主要空闲进程如何具有高 ELU 的示例。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("'use strict';\nconst { eventLoopUtilization } = require('perf_hooks').performance;\nconst { spawnSync } = require('child_process');\n\nsetImmediate(() => {\n  const elu = eventLoopUtilization();\n  spawnSync('sleep', ['5']);\n  console.log(eventLoopUtilization(elu).utilization);\n});\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("p",[e._v("虽然运行这个脚本时 CPU 大部分是空闲的，但 "),n("code",[e._v("utilization")]),e._v(" 的值为 "),n("code",[e._v("1")]),e._v("。 这是因为对 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/child_process.html#child_process_child_process_spawnsync_command_args_options",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("child_process.spawnSync()")]),n("OutboundLink")],1),e._v(" 的调用阻止了事件循环的进行。")]),e._v(" "),n("p",[e._v("传入用户定义的对象而不是先前调用 "),n("code",[e._v("eventLoopUtilization()")]),e._v(" 的结果将导致未定义的行为。 不保证返回值反映事件循环的任何正确状态。")]),e._v(" "),n("h4",{attrs:{id:"performance-mark-name"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-mark-name"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.mark([name])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancemarkname",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_mark_name.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("name")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("在性能时间轴中创建新的 "),n("code",[e._v("PerformanceMark")]),e._v(" 条目。 "),n("code",[e._v("PerformanceMark")]),e._v(" 是 "),n("code",[e._v("PerformanceEntry")]),e._v(" 的子类，其 "),n("code",[e._v("performanceEntry.entryType")]),e._v(" 始终为 "),n("code",[e._v("'mark'")]),e._v("，而其 "),n("code",[e._v("performanceEntry.duration")]),e._v(" 始终为 "),n("code",[e._v("0")]),e._v("。 性能标记用于标记性能时间轴中的特定重要时刻。")]),e._v(" "),n("h4",{attrs:{id:"performance-measure-name-startmark-endmark"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-measure-name-startmark-endmark"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.measure(name[, startMark[, endMark]])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancemeasurename-startmark-endmark",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_measure_name_startmark_endmark.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("ul",[n("li",[n("code",[e._v("name")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("startMark")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 可选的。")]),e._v(" "),n("li",[n("code",[e._v("endMark")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 可选的。")])]),e._v(" "),n("p",[e._v("在性能时间轴中创建新的 "),n("code",[e._v("PerformanceMeasure")]),e._v(" 条目。 "),n("code",[e._v("PerformanceMeasure")]),e._v(" 是 "),n("code",[e._v("PerformanceEntry")]),e._v(" 的子类，其 "),n("code",[e._v("performanceEntry.entryType")]),e._v(" 始终为 "),n("code",[e._v("'measure'")]),e._v("，其 "),n("code",[e._v("performanceEntry.duration")]),e._v(" 测量自 "),n("code",[e._v("startMark")]),e._v(" 和 "),n("code",[e._v("endMark")]),e._v(" 以来经过的毫秒数。")]),e._v(" "),n("p",[n("code",[e._v("startMark")]),e._v(" 参数可以标识性能时间轴中的任何现有的 "),n("code",[e._v("PerformanceMark")]),e._v("，或者可能标识由 "),n("code",[e._v("PerformanceNodeTiming")]),e._v(" 类提供的任何时间戳属性。 如果命名的 "),n("code",[e._v("startMark")]),e._v(" 不存在，则默认情况下将 "),n("code",[e._v("startMark")]),e._v(" 设置为 "),n("a",{attrs:{href:"http://url.nodejs.cn/WSrFaU",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("timeOrigin")]),n("OutboundLink")],1),e._v("。")]),e._v(" "),n("p",[e._v("可选的 "),n("code",[e._v("endMark")]),e._v(" 参数必须标识性能时间轴中的任何现有的 "),n("code",[e._v("PerformanceMark")]),e._v(" 或 "),n("code",[e._v("PerformanceNodeTiming")]),e._v(" 类提供的任何时间戳属性。 不传入参数则 "),n("code",[e._v("endMark")]),e._v(" 为 "),n("code",[e._v("performance.now()")]),e._v("，否则如果命名的 "),n("code",[e._v("endMark")]),e._v(" 不存在，则抛出错误。")]),e._v(" "),n("h4",{attrs:{id:"performance-nodetiming"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-nodetiming"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.nodeTiming")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetiming",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_nodetiming.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#class-performancenodetiming",target:"_blank",rel:"noopener noreferrer"}},[n("PerformanceNodeTiming",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[n("em",[e._v("此属性是 Node.js 的扩展。 它在 Web 浏览器中不可用。")])]),e._v(" "),n("p",[n("code",[e._v("PerformanceNodeTiming")]),e._v(" 类的实例，为特定的 Node.js 操作里程碑提供性能指标。")]),e._v(" "),n("h4",{attrs:{id:"performance-now"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-now"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.now()")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenow",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_now.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[e._v("返回: "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("返回当前的高解析度毫秒时间戳，其中 0 表示当前的 "),n("code",[e._v("node")]),e._v(" 进程的开始。")]),e._v(" "),n("h4",{attrs:{id:"performance-timeorigin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-timeorigin"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.timeOrigin")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancetimeorigin",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_timeorigin.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[n("a",{attrs:{href:"http://url.nodejs.cn/WSrFaU",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("timeOrigin")]),n("OutboundLink")],1),e._v(" 指定了当前的 "),n("code",[e._v("node")]),e._v(" 进程开始的高解析度毫秒时间戳，以 Unix 时间度量。")]),e._v(" "),n("h4",{attrs:{id:"performance-timerify-fn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-timerify-fn"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.timerify(fn)")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancetimerifyfn",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_timerify_fn.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("fn")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[n("em",[e._v("此属性是 Node.js 的扩展。 它在 Web 浏览器中不可用。")])]),e._v(" "),n("p",[e._v("将函数封装在测量被封装函数运行时间的新函数中。 "),n("code",[e._v("PerformanceObserver")]),e._v(" 必须订阅 "),n("code",[e._v("'function'")]),e._v(" 事件类型才能访问时间细节。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const {\n  performance,\n  PerformanceObserver\n} = require('perf_hooks');\n\nfunction someFunction() {\n  console.log('hello world');\n}\n\nconst wrapped = performance.timerify(someFunction);\n\nconst obs = new PerformanceObserver((list) => {\n  console.log(list.getEntries()[0].duration);\n  obs.disconnect();\n});\nobs.observe({ entryTypes: ['function'] });\n\n// 将创建性能时间轴条目\nwrapped();\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br")])]),n("h4",{attrs:{id:"performance-eventlooputilization-util1-util2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performance-eventlooputilization-util1-util2"}},[e._v("#")]),e._v(" "),n("code",[e._v("performance.eventLoopUtilization([util1][,util2])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceeventlooputilizationutil1util2",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performance_eventlooputilization_util1_util2.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v12.19.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("util1")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" 先前调用 "),n("code",[e._v("eventLoopUtilization()")]),e._v(" 的结果")]),e._v(" "),n("li",[n("code",[e._v("util2")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[e._v("返回 "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" "),n("ul",[n("li",[n("code",[e._v("idle")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("active")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("utilization")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])])])]),e._v(" "),n("p",[n("code",[e._v("eventLoopUtilization()")]),e._v(" 方法返回包含事件循环作为高解析度毫秒计时器的既空闲又活动的累积持续时间的对象。 "),n("code",[e._v("utilization")]),e._v(" 值是计算的事件循环利用率 (ELU)。")]),e._v(" "),n("p",[e._v("它表示事件循环在事件循环的事件提供者（例如 "),n("code",[e._v("epoll_wait")]),e._v("）之外花费的时间百分比。 不考虑其他 CPU 空闲时间。 以下是主要空闲进程如何具有高 ELU 的示例。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("'use strict';\nconst { eventLoopUtilization } = require('perf_hooks').performance;\nconst { spawnSync } = require('child_process');\n\nsetImmediate(() => {\n  const elu = eventLoopUtilization();\n  spawnSync('sleep', ['5']);\n  console.log(eventLoopUtilization(elu).utilization);\n});\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("p",[e._v("这是因为对 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/child_process.html#child_process_child_process_spawnsync_command_args_options",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("child_process.spawnSync()")]),n("OutboundLink")],1),e._v(" 的调用阻止了事件循环的进行。")]),e._v(" "),n("p",[e._v("传入用户定义的对象而不是先前调用 "),n("code",[e._v("eventLoopUtilization()")]),e._v(" 的结果将导致未定义的行为。 不保证返回值反映事件循环的任何正确状态。")]),e._v(" "),n("h3",{attrs:{id:"performanceentry-类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceentry-类"}},[e._v("#")]),e._v(" "),n("code",[e._v("PerformanceEntry")]),e._v(" 类"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#class-performanceentry",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("h4",{attrs:{id:"performanceentry-duration"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceentry-duration"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceEntry.duration")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceentryduration",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceentry_duration.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("此条目经过的总毫秒数。 此值对所有性能条目类型都没有意义。")]),e._v(" "),n("h4",{attrs:{id:"performanceentry-name"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceentry-name"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceEntry.name")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceentryname",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceentry_name.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("性能条目的名称。")]),e._v(" "),n("h4",{attrs:{id:"performanceentry-starttime"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceentry-starttime"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceEntry.startTime")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceentrystarttime",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceentry_starttime.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("标记性能条目开始时间的高解析度毫秒时间戳。")]),e._v(" "),n("h4",{attrs:{id:"performanceentry-entrytype"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceentry-entrytype"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceEntry.entryType")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceentryentrytype",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceentry_entrytype.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("性能条目的类型。 它可能是以下之一：")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("'node'")]),e._v("（仅限 Node.js）")]),e._v(" "),n("li",[n("code",[e._v("'mark'")]),e._v("（在 Web 上可用）")]),e._v(" "),n("li",[n("code",[e._v("'measure'")]),e._v("（在 Web 上可用）")]),e._v(" "),n("li",[n("code",[e._v("'gc'")]),e._v("（仅限 Node.js）")]),e._v(" "),n("li",[n("code",[e._v("'function'")]),e._v("（仅限 Node.js）")]),e._v(" "),n("li",[n("code",[e._v("'http2'")]),e._v("（仅限 Node.js）")]),e._v(" "),n("li",[n("code",[e._v("'http'")]),e._v("（仅限 Node.js）")])]),e._v(" "),n("h4",{attrs:{id:"performanceentry-kind"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceentry-kind"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceEntry.kind")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceentrykind",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceentry_kind.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[n("em",[e._v("此属性是 Node.js 的扩展。 它在 Web 浏览器中不可用。")])]),e._v(" "),n("p",[e._v("当 "),n("code",[e._v("performanceEntry.entryType")]),e._v(" 等于 "),n("code",[e._v("'gc'")]),e._v(" 时，则 "),n("code",[e._v("performance.kind")]),e._v(" 属性标识发生的垃圾收集操作的类型。 该值可能是以下之一：")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_MAJOR")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_MINOR")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_INCREMENTAL")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_WEAKCB")])])]),e._v(" "),n("h4",{attrs:{id:"performanceentry-flags"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceentry-flags"}},[e._v("#")]),e._v(" performanceEntry.flags"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceentryflags",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceentry_flags.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v12.17.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[n("em",[e._v("此属性是 Node.js 的扩展。 它在 Web 浏览器中不可用。")])]),e._v(" "),n("p",[e._v("当 "),n("code",[e._v("performanceEntry.entryType")]),e._v(" 等于 "),n("code",[e._v("'gc'")]),e._v(" 时，则 "),n("code",[e._v("performance.flags")]),e._v(" 属性包含有关垃圾收集操作的附加信息。 该值可能是以下之一：")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_FLAGS_NO")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_FLAGS_CONSTRUCT_RETAINED")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_FLAGS_FORCED")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_FLAGS_SYNCHRONOUS_PHANTOM_PROCESSING")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_FLAGS_ALL_AVAILABLE_GARBAGE")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_FLAGS_ALL_EXTERNAL_MEMORY")])]),e._v(" "),n("li",[n("code",[e._v("perf_hooks.constants.NODE_PERFORMANCE_GC_FLAGS_SCHEDULE_IDLE")])])]),e._v(" "),n("h3",{attrs:{id:"performancenodetiming-extends-performanceentry-类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-extends-performanceentry-类"}},[e._v("#")]),e._v(" "),n("code",[e._v("PerformanceNodeTiming extends PerformanceEntry")]),e._v(" 类"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#class-performancenodetiming-extends-performanceentry",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/class_performancenodetiming_extends_performanceentry.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("p",[n("em",[e._v("此属性是 Node.js 的扩展。 它在 Web 浏览器中不可用。")])]),e._v(" "),n("p",[e._v("为 Node.js 本身提供计时细节。 此类的构造函数不会暴露给用户。")]),e._v(" "),n("h4",{attrs:{id:"performancenodetiming-bootstrapcomplete"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-bootstrapcomplete"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceNodeTiming.bootstrapComplete")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetimingbootstrapcomplete",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performancenodetiming_bootstrapcomplete.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("Node.js 进程完成引导的高解析度毫秒时间戳。 如果引导尚未完成，则该属性的值为 -1。")]),e._v(" "),n("h4",{attrs:{id:"performancenodetiming-environment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-environment"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceNodeTiming.environment")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetimingenvironment",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performancenodetiming_environment.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("Node.js 环境初始化的高解析度毫秒时间戳。")]),e._v(" "),n("h4",{attrs:{id:"performancenodetiming-loopexit"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-loopexit"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceNodeTiming.loopExit")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetimingloopexit",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performancenodetiming_loopexit.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("Node.js 事件循环退出时的高解析度毫秒时间戳。 如果事件循环尚未退出，则该属性的值为 -1。 它只能在 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/process.html#process_event_exit",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("'exit'")]),n("OutboundLink")],1),e._v(" 事件的句柄中具有非 -1 的值。")]),e._v(" "),n("h4",{attrs:{id:"performancenodetiming-loopstart"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-loopstart"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceNodeTiming.loopStart")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetimingloopstart",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performancenodetiming_loopstart.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("Node.js 事件循环开始的高解析度毫秒时间戳。 如果事件循环尚未开始（例如，在主脚本的第一个滴答中），则该属性的值为 -1。")]),e._v(" "),n("h4",{attrs:{id:"performancenodetiming-nodestart"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-nodestart"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceNodeTiming.nodeStart")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetimingnodestart",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performancenodetiming_nodestart.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("Node.js 进程初始化的高解析度毫秒时间戳。")]),e._v(" "),n("h4",{attrs:{id:"performancenodetiming-v8start"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-v8start"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceNodeTiming.v8Start")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetimingv8start",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performancenodetiming_v8start.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("V8 平台初始化的高解析度毫秒时间戳。")]),e._v(" "),n("h4",{attrs:{id:"performancenodetiming-idletime"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performancenodetiming-idletime"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceNodeTiming.idleTime")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performancenodetimingidletime",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performancenodetiming_idletime.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v12.19.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("事件循环在事件循环的事件提供者（例如 "),n("code",[e._v("epoll_wait")]),e._v("）中空闲的时间量的高解析度毫秒时间戳。 这不考虑 CPU 使用率。 如果事件循环尚未开始（例如，在主脚本的第一个滴答中），则该属性的值为 0。")]),e._v(" "),n("h3",{attrs:{id:"perf-hooks-performanceobserver-类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#perf-hooks-performanceobserver-类"}},[e._v("#")]),e._v(" "),n("code",[e._v("perf_hooks.PerformanceObserver")]),e._v(" 类"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#class-perf_hooksperformanceobserver",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("h4",{attrs:{id:"new-performanceobserver-callback"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#new-performanceobserver-callback"}},[e._v("#")]),e._v(" "),n("code",[e._v("new PerformanceObserver(callback)")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#new-performanceobservercallback",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/new_performanceobserver_callback.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("callback")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1),e._v(" "),n("ul",[n("li",[n("code",[e._v("list")]),e._v(" "),n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#class-performanceobserverentrylist",target:"_blank",rel:"noopener noreferrer"}},[n("PerformanceObserverEntryList",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("observer")]),e._v(" "),n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#class-perf_hooksperformanceobserver",target:"_blank",rel:"noopener noreferrer"}},[n("PerformanceObserver",[n("OutboundLink")],1)],1)])])])]),e._v(" "),n("p",[e._v("当新的 "),n("code",[e._v("PerformanceEntry")]),e._v(" 实例被添加到性能时间线时，则 "),n("code",[e._v("PerformanceObserver")]),e._v(" 对象会提供通知。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const {\n  performance,\n  PerformanceObserver\n} = require('perf_hooks');\n\nconst obs = new PerformanceObserver((list, observer) => {\n  console.log(list.getEntries());\n  observer.disconnect();\n});\nobs.observe({ entryTypes: ['mark'], buffered: true });\n\nperformance.mark('test');\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("p",[e._v("因为 "),n("code",[e._v("PerformanceObserver")]),e._v(" 实例引入了它们自己的额外性能开销，实例不应无限期地订阅通知。 一旦不再需要观察者，则用户应立即断开观察者的连接。")]),e._v(" "),n("p",[e._v("当 "),n("code",[e._v("PerformanceObserver")]),e._v(" 接收到有关新的 "),n("code",[e._v("PerformanceEntry")]),e._v(" 实例的通知时，则会调用 "),n("code",[e._v("callback")]),e._v("。 回调接收到 "),n("code",[e._v("PerformanceObserverEntryList")]),e._v(" 实例和对 "),n("code",[e._v("PerformanceObserver")]),e._v(" 的引用。")]),e._v(" "),n("h4",{attrs:{id:"performanceobserver-disconnect"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceobserver-disconnect"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceObserver.disconnect()")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceobserverdisconnect",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceobserver_disconnect.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("p",[e._v("断开 "),n("code",[e._v("PerformanceObserver")]),e._v(" 实例与所有通知的连接。")]),e._v(" "),n("h4",{attrs:{id:"performanceobserver-observe-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceobserver-observe-options"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceObserver.observe(options)")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceobserverobserveoptions",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceobserver_observe_options.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("options")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" "),n("ul",[n("li",[n("code",[e._v("entryTypes")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[e._v("<string[]>"),n("OutboundLink")],1),e._v(" 标识观察者感兴趣的 "),n("code",[e._v("PerformanceEntry")]),e._v(" 实例类型的字符串数组。 如果未提供，将抛出错误。")]),e._v(" "),n("li",[n("code",[e._v("buffered")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1),e._v(" 如果为 true，则通知回调将使用 "),n("code",[e._v("setImmediate()")]),e._v(" 调用，多个 "),n("code",[e._v("PerformanceEntry")]),e._v(" 实例通知将在内部缓冲。 如果为 "),n("code",[e._v("false")]),e._v("，则通知将是即时和同步的。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("false")]),e._v("。")])])])]),e._v(" "),n("p",[e._v("为 "),n("code",[e._v("PerformanceObserver")]),e._v(" 实例订阅由 "),n("code",[e._v("options.entryTypes")]),e._v(" 标识的新 "),n("code",[e._v("PerformanceEntry")]),e._v(" 实例的通知。")]),e._v(" "),n("p",[e._v("当 "),n("code",[e._v("options.buffered")]),e._v(" 为 "),n("code",[e._v("false")]),e._v(" 时，则 "),n("code",[e._v("callback")]),e._v(" 会为每个 "),n("code",[e._v("PerformanceEntry")]),e._v(" 实例调用一次：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const {\n  performance,\n  PerformanceObserver\n} = require('perf_hooks');\n\nconst obs = new PerformanceObserver((list, observer) => {\n  // 同步地调用 3 次。`list` 包含一项。\n});\nobs.observe({ entryTypes: ['mark'] });\n\nfor (let n = 0; n < 3; n++)\n  performance.mark(`test${n}`);\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const {\n  performance,\n  PerformanceObserver\n} = require('perf_hooks');\n\nconst obs = new PerformanceObserver((list, observer) => {\n  // 调用一次。`list` 包含三个条目。\n});\nobs.observe({ entryTypes: ['mark'], buffered: true });\n\nfor (let n = 0; n < 3; n++)\n  performance.mark(`test${n}`);\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("h3",{attrs:{id:"performanceobserverentrylist-类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceobserverentrylist-类"}},[e._v("#")]),e._v(" "),n("code",[e._v("PerformanceObserverEntryList")]),e._v(" 类"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#class-performanceobserverentrylist",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/class_performanceobserverentrylist.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("p",[n("code",[e._v("PerformanceObserverEntryList")]),e._v(" 类用于提供对传给 "),n("code",[e._v("PerformanceObserver")]),e._v(" 的 "),n("code",[e._v("PerformanceEntry")]),e._v(" 实例的访问。 此类的构造函数不会暴露给用户。")]),e._v(" "),n("h4",{attrs:{id:"performanceobserverentrylist-getentries"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceobserverentrylist-getentries"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceObserverEntryList.getEntries()")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceobserverentrylistgetentries",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceobserverentrylist_getentries.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[e._v("返回: "),n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#class-performanceentry",target:"_blank",rel:"noopener noreferrer"}},[e._v("<PerformanceEntry[]>"),n("OutboundLink")],1)])]),e._v(" "),n("p",[e._v("返回 "),n("code",[e._v("PerformanceEntry")]),e._v(" 对象的列表，按照相对于 "),n("code",[e._v("performanceEntry.startTime")]),e._v(" 的时间顺序排列。")]),e._v(" "),n("h4",{attrs:{id:"performanceobserverentrylist-getentriesbyname-name-type"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceobserverentrylist-getentriesbyname-name-type"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceObserverEntryList.getEntriesByName(name[, type])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceobserverentrylistgetentriesbynamename-type",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceobserverentrylist_getentriesbyname_name_type.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("name")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("type")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[e._v("返回: "),n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#class-performanceentry",target:"_blank",rel:"noopener noreferrer"}},[e._v("<PerformanceEntry[]>"),n("OutboundLink")],1)])]),e._v(" "),n("p",[e._v("返回按时间顺序的 "),n("code",[e._v("PerformanceEntry")]),e._v(" 对象列表，其中 "),n("code",[e._v("performanceEntry.startTime")]),e._v(" 的 "),n("code",[e._v("performanceEntry.name")]),e._v(" 等于 "),n("code",[e._v("name")]),e._v("，并且可选地，其 "),n("code",[e._v("performanceEntry.entryType")]),e._v(" 等于 "),n("code",[e._v("type")]),e._v("。")]),e._v(" "),n("h4",{attrs:{id:"performanceobserverentrylist-getentriesbytype-type"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#performanceobserverentrylist-getentriesbytype-type"}},[e._v("#")]),e._v(" "),n("code",[e._v("performanceObserverEntryList.getEntriesByType(type)")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#performanceobserverentrylistgetentriesbytypetype",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/performanceobserverentrylist_getentriesbytype_type.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v8.5.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("type")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[e._v("返回: "),n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#class-performanceentry",target:"_blank",rel:"noopener noreferrer"}},[e._v("<PerformanceEntry[]>"),n("OutboundLink")],1)])]),e._v(" "),n("p",[e._v("返回按时间顺序排列的 "),n("code",[e._v("PerformanceEntry")]),e._v(" 对象列表，其中 "),n("code",[e._v("performanceEntry.startTime")]),e._v(" 的 "),n("code",[e._v("performanceEntry.entryType")]),e._v(" 等于 "),n("code",[e._v("type")]),e._v("。")]),e._v(" "),n("h3",{attrs:{id:"perf-hooks-monitoreventloopdelay-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#perf-hooks-monitoreventloopdelay-options"}},[e._v("#")]),e._v(" "),n("code",[e._v("perf_hooks.monitorEventLoopDelay([options])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#perf_hooksmonitoreventloopdelayoptions",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/perf_hooks_monitoreventloopdelay_options.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("options")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" "),n("ul",[n("li",[n("code",[e._v("resolution")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1),e._v(" 以毫秒为单位的采样率。 必须大于零。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("10")]),e._v("。")])])]),e._v(" "),n("li",[e._v("返回: "),n("a",{attrs:{href:"http://nodejs.cn/api/perf_hooks.html#class-histogram",target:"_blank",rel:"noopener noreferrer"}},[n("Histogram",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[n("em",[e._v("此属性是 Node.js 的扩展。 它在 Web 浏览器中不可用。")])]),e._v(" "),n("p",[e._v("延迟将以纳秒为单位报告。")]),e._v(" "),n("p",[e._v("使用计时器来检测近似的事件循环延迟是有效的，因为计时器的执行与 libuv 事件循环的生命周期特别相关。 也就是说，循环中的延迟会导致计时器执行的延迟，而这些延迟正是此 API 旨在检测的。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const { monitorEventLoopDelay } = require('perf_hooks');\nconst h = monitorEventLoopDelay({ resolution: 20 });\nh.enable();\n// 做点什么。\nh.disable();\nconsole.log(h.min);\nconsole.log(h.max);\nconsole.log(h.mean);\nconsole.log(h.stddev);\nconsole.log(h.percentiles);\nconsole.log(h.percentile(50));\nconsole.log(h.percentile(99));\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("h4",{attrs:{id:"histogram-类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-类"}},[e._v("#")]),e._v(" "),n("code",[e._v("Histogram")]),e._v(" 类"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#class-histogram",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/class_histogram.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("p",[n("em",[e._v("此属性是 Node.js 的扩展。 它在 Web 浏览器中不可用。")])]),e._v(" "),n("h5",{attrs:{id:"histogram-disable"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-disable"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.disable()")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogramdisable",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_disable.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[e._v("返回: "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("如果计时器被停止，则返回 "),n("code",[e._v("true")]),e._v("，如果已被停止，则返回 "),n("code",[e._v("false")]),e._v("。")]),e._v(" "),n("h5",{attrs:{id:"histogram-enable"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-enable"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.enable()")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogramenable",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_enable.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[e._v("返回: "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("如果计时器被启动，则返回 "),n("code",[e._v("true")]),e._v("，如果已被启动，则返回 "),n("code",[e._v("false")]),e._v("。")]),e._v(" "),n("h5",{attrs:{id:"histogram-exceeds"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-exceeds"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.exceeds")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogramexceeds",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_exceeds.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("事件循环延迟超过最大 1 小时事件循环延迟阈值的次数。")]),e._v(" "),n("h5",{attrs:{id:"histogram-max"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-max"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.max")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogrammax",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_max.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("记录的事件循环延迟的最大值。")]),e._v(" "),n("h5",{attrs:{id:"histogram-mean"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-mean"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.mean")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogrammean",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_mean.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("记录的事件循环延迟的平均值。")]),e._v(" "),n("h5",{attrs:{id:"histogram-min"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-min"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.min")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogrammin",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_min.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("记录的事件循环延迟的最小值。")]),e._v(" "),n("h5",{attrs:{id:"histogram-percentile-percentile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-percentile-percentile"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.percentile(percentile)")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogrampercentilepercentile",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_percentile_percentile.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("percentile")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[e._v("返回: "),n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("返回给定的百分位数的值。")]),e._v(" "),n("h5",{attrs:{id:"histogram-percentiles"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-percentiles"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.percentiles")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogrampercentiles",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_percentiles.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/EnuJtG",target:"_blank",rel:"noopener noreferrer"}},[n("Map",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("返回详细说明累积的百分位分布的 "),n("code",[e._v("Map")]),e._v(" 对象。")]),e._v(" "),n("h5",{attrs:{id:"histogram-reset"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-reset"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.reset()")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogramreset",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_reset.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("p",[e._v("重置收集的直方图数据。")]),e._v(" "),n("h5",{attrs:{id:"histogram-stddev"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#histogram-stddev"}},[e._v("#")]),e._v(" "),n("code",[e._v("histogram.stddev")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#histogramstddev",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/histogram_stddev.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://url.nodejs.cn/SXbo1v",target:"_blank",rel:"noopener noreferrer"}},[n("number",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("记录的事件循环延迟的标准偏差。")]),e._v(" "),n("h3",{attrs:{id:"示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[e._v("#")]),e._v(" 示例"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#examples",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("h4",{attrs:{id:"测量异步操作的时长"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测量异步操作的时长"}},[e._v("#")]),e._v(" 测量异步操作的时长"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#measuring-the-duration-of-async-operations",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/measuring_the_duration_of_async_operations.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("以下示例使用"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/async_hooks.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("异步钩子"),n("OutboundLink")],1),e._v("和性能 API 来测量超时操作的实际持续时间（包括执行回调所花费的时间）。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("'use strict';\nconst async_hooks = require('async_hooks');\nconst {\n  performance,\n  PerformanceObserver\n} = require('perf_hooks');\n\nconst set = new Set();\nconst hook = async_hooks.createHook({\n  init(id, type) {\n    if (type === 'Timeout') {\n      performance.mark(`Timeout-${id}-Init`);\n      set.add(id);\n    }\n  },\n  destroy(id) {\n    if (set.has(id)) {\n      set.delete(id);\n      performance.mark(`Timeout-${id}-Destroy`);\n      performance.measure(`Timeout-${id}`,\n                          `Timeout-${id}-Init`,\n                          `Timeout-${id}-Destroy`);\n    }\n  }\n});\nhook.enable();\n\nconst obs = new PerformanceObserver((list, observer) => {\n  console.log(list.getEntries()[0]);\n  performance.clearMarks();\n  observer.disconnect();\n});\nobs.observe({ entryTypes: ['measure'], buffered: true });\n\nsetTimeout(() => {}, 1000);\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br"),n("span",{staticClass:"line-number"},[e._v("32")]),n("br"),n("span",{staticClass:"line-number"},[e._v("33")]),n("br"),n("span",{staticClass:"line-number"},[e._v("34")]),n("br"),n("span",{staticClass:"line-number"},[e._v("35")]),n("br")])]),n("h4",{attrs:{id:"测量加载依赖的耗时"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测量加载依赖的耗时"}},[e._v("#")]),e._v(" 测量加载依赖的耗时"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks.html#measuring-how-long-it-takes-to-load-dependencies",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/perf_hooks/measuring_how_long_it_takes_to_load_dependencies.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("以下示例测量加载依赖项的 "),n("code",[e._v("require()")]),e._v(" 操作的持续时间：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("'use strict';\nconst {\n  performance,\n  PerformanceObserver\n} = require('perf_hooks');\nconst mod = require('module');\n\n// Monkey 修补 require 函数\nmod.Module.prototype.require =\n  performance.timerify(mod.Module.prototype.require);\nrequire = performance.timerify(require);\n\n// 激活观察者\nconst obs = new PerformanceObserver((list) => {\n  const entries = list.getEntries();\n  entries.forEach((entry) => {\n    console.log(`require('${entry[0]}')`, entry.duration);\n  });\n  obs.disconnect();\n});\nobs.observe({ entryTypes: ['function'], buffered: true });\n\nrequire('some-module');\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br")])])])}),[],!1,null,null,null);r.default=a.exports}}]);