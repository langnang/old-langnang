(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{629:function(e,r,n){"use strict";n.r(r);var t=n(18),a=Object(t.a)({},(function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"repl-交互式解释器-node-js-api-文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#repl-交互式解释器-node-js-api-文档"}},[e._v("#")]),e._v(" repl 交互式解释器 | Node.js API 文档")]),e._v(" "),n("blockquote",[n("h2",{attrs:{id:"excerpt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#excerpt"}},[e._v("#")]),e._v(" Excerpt")]),e._v(" "),n("p",[e._v("中英对照")])]),e._v(" "),n("hr"),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/repl.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("strong",[e._v("源代码:")]),e._v(" "),n("a",{attrs:{href:"https://github.com/nodejs/node/blob/v12.22.12/lib/repl.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("lib/repl.js"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("code",[e._v("repl")]),e._v(" 模块提供了一个读取-评估-打印-循环 (REPL) 实现，它既可以作为独立程序使用，也可以包含在其他应用程序中。 可以使用以下方式访问它：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("h3",{attrs:{id:"设计与特性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设计与特性"}},[e._v("#")]),e._v(" 设计与特性"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#design-and-features",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/design_and_features.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("code",[e._v("repl")]),e._v(" 模块导出 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 类。 当运行时，"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 的实例将接受用户输入的单行，根据用户定义的评估函数评估它们，然后输出结果。 输入和输出可能分别来自 "),n("code",[e._v("stdin")]),e._v(" 和 "),n("code",[e._v("stdout")]),e._v("，也可能连接到任何 Node.js "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/stream.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("流"),n("OutboundLink")],1),e._v("。")]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 实例支持自动补全输入、补全预览、简单的 Emacs 风格的行编辑、多行输入、类 "),n("a",{attrs:{href:"http://url.nodejs.cn/7UdTEN",target:"_blank",rel:"noopener noreferrer"}},[e._v("ZSH"),n("OutboundLink")],1),e._v(" 的反向搜索、类 "),n("a",{attrs:{href:"http://url.nodejs.cn/7UdTEN",target:"_blank",rel:"noopener noreferrer"}},[e._v("ZSH"),n("OutboundLink")],1),e._v(" 的基于子串的历史搜索、ANSI 风格的输出、保存和恢复当前 REPL 会话状态、错误恢复和可定制的评估函数。 不支持 ANSI 风格和 Emacs 风格的行编辑的终端会自动回退到有限的功能集。")]),e._v(" "),n("h4",{attrs:{id:"命令与特殊键"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令与特殊键"}},[e._v("#")]),e._v(" 命令与特殊键"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#commands-and-special-keys",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/commands_and_special_keys.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("所有 REPL 实例都支持以下特殊命令：")]),e._v(" "),n("ul",[n("li",[n("code",[e._v(".break")]),e._v(":")]),e._v(" "),n("li",[n("code",[e._v(".clear")]),e._v(": 将 REPL "),n("code",[e._v("context")]),e._v(" 重置为空对象并清除任何输入的多行表达式。")]),e._v(" "),n("li",[n("code",[e._v(".exit")]),e._v(": 关闭 I/O 流，导致 REPL 退出。")]),e._v(" "),n("li",[n("code",[e._v(".help")]),e._v(": 显示此特殊命令列表。")]),e._v(" "),n("li",[n("code",[e._v(".save")]),e._v(": 将当前 REPL 会话保存到文件："),n("code",[e._v("> .save ./file/to/save.js")])]),e._v(" "),n("li",[n("code",[e._v(".load")]),e._v(": 将文件加载到当前 REPL 会话中。 "),n("code",[e._v("> .load ./file/to/load.js")])]),e._v(" "),n("li",[n("code",[e._v(".editor")]),e._v(":")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> .editor\n// 进入编辑器模式（^D 完成，^C 取消）\nfunction welcome(name) {\n  return `Hello ${name}!`;\n}\n\nwelcome('Node.js User');\n\n// ^D\n'Hello Node.js User!'\n>\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("p",[e._v("REPL 中的以下组合键具有这些特殊效果：")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("<ctrl>-C")]),e._v(": 当在空白行上按两次时，效果与 "),n("code",[e._v(".exit")]),e._v(" 命令相同。")]),e._v(" "),n("li",[n("code",[e._v("<ctrl>-D")]),e._v(":")]),e._v(" "),n("li",[n("code",[e._v("<tab>")]),e._v(": 当在输入其他输入时按下时，显示相关的自动完成选项。")])]),e._v(" "),n("p",[e._v("有关反向搜索的键绑定，请参阅 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_reverse_i_search",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("reverse-i-search")]),n("OutboundLink")],1),e._v("。 对于所有其他键绑定，请参阅 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/readline.html#readline_tty_keybindings",target:"_blank",rel:"noopener noreferrer"}},[e._v("TTY 键绑定"),n("OutboundLink")],1),e._v("。")]),e._v(" "),n("h4",{attrs:{id:"默认的解释器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#默认的解释器"}},[e._v("#")]),e._v(" 默认的解释器"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#default-evaluation",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/default_evaluation.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("默认情况下，"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 的所有实例都使用评估函数来评估 JavaScript 表达式并提供对 Node.js 内置模块的访问。 可以通过在创建 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 实例时传入替代评估函数来覆盖此默认行为。")]),e._v(" "),n("h5",{attrs:{id:"javascript-表达式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#javascript-表达式"}},[e._v("#")]),e._v(" JavaScript 表达式"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#javascript-expressions",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/javascript_expressions.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("默认的求值器支持 JavaScript 表达式的直接求值：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> 1 + 1\n2\n> const m = 2\nundefined\n> m + 1\n3\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("p",[e._v("除非在块或函数内另有作用域，否则隐式声明或使用 "),n("code",[e._v("const")]),e._v("、"),n("code",[e._v("let")]),e._v(" 或 "),n("code",[e._v("var")]),e._v(" 关键字声明的变量在全局作用域内声明。")]),e._v(" "),n("h5",{attrs:{id:"全局作用域与局部作用域"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#全局作用域与局部作用域"}},[e._v("#")]),e._v(" 全局作用域与局部作用域"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#global-and-local-scope",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/global_and_local_scope.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("默认求值器提供对全局作用域中存在的任何变量的访问。 可以通过将变量分配给与每个 "),n("code",[e._v("REPLServer")]),e._v(" 关联的 "),n("code",[e._v("context")]),e._v(" 对象来显式地向 REPL 公开变量：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\nconst msg = 'message';\n\nrepl.start('> ').context.m = msg;\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("p",[n("code",[e._v("context")]),e._v(" 对象中的属性在 REPL 中显示为本地：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ node repl_test.js\n> m\n'message'\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("p",[e._v("默认情况下上下文属性不是只读的。 要指定只读的全局变量，则必须使用 "),n("code",[e._v("Object.defineProperty()")]),e._v(" 定义上下文属性：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\nconst msg = 'message';\n\nconst r = repl.start('> ');\nObject.defineProperty(r.context, 'm', {\n  configurable: false,\n  enumerable: true,\n  value: msg\n});\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("h5",{attrs:{id:"访问-node-js-核心模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#访问-node-js-核心模块"}},[e._v("#")]),e._v(" 访问 Node.js 核心模块"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#accessing-core-nodejs-modules",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/accessing_core_node_js_modules.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("默认的求值器会在使用时自动将 Node.js 核心模块加载到 REPL 环境中。 例如，除非另外声明为全局变量或作用域变量，否则输入 "),n("code",[e._v("fs")]),e._v(" 将按需评估为 "),n("code",[e._v("global.fs = require('fs')")]),e._v("。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> fs.createReadStream('./some/file');\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("h5",{attrs:{id:"全局的未捕获异常"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#全局的未捕获异常"}},[e._v("#")]),e._v(" 全局的未捕获异常"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#global-uncaught-exceptions",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/global_uncaught_exceptions.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("REPL 使用 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/domain.html",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("domain")]),n("OutboundLink")],1),e._v(" 模块来捕获该 REPL 会话的所有未捕获的异常。")]),e._v(" "),n("p",[e._v("在 REPL 中使用 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/domain.html",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("domain")]),n("OutboundLink")],1),e._v(" 模块有这些副作用：")]),e._v(" "),n("ul",[n("li",[n("p",[e._v("未捕获的异常仅在独立 REPL 中触发 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/process.html#process_event_uncaughtexception",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("'uncaughtException'")]),n("OutboundLink")],1),e._v(" 事件。")])]),e._v(" "),n("li",[n("p",[e._v("尝试使用 ["),n("code",[e._v("process.setExceptionCaptureCallback()")]),e._v("][] 会抛出 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/errors.html#errors_err_domain_cannot_set_uncaught_exception_capture",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("ERR_DOMAIN_CANNOT_SET_UNCAUGHT_EXCEPTION_CAPTURE")]),n("OutboundLink")],1),e._v(" 错误。")])])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("process.on('uncaughtException', () => console.log('Uncaught'));\n\nthrow new Error('foobar');\n// Uncaught\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("process.on('uncaughtException', () => console.log('Uncaught'));\n// TypeError [ERR_INVALID_REPL_INPUT]: Listeners for `uncaughtException`\n// \n\nthrow new Error('foobar');\n// \n// \n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("h5",{attrs:{id:"下划线-变量的赋值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#下划线-变量的赋值"}},[e._v("#")]),e._v(" _（下划线）变量的赋值"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#assignment-of-the-_-underscore-variable",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/assignment_of_the_underscore_variable.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("默认情况下，默认求值器会将最近求值的表达式的结果分配给特殊变量 "),n("code",[e._v("_")]),e._v("（下划线）。 将 "),n("code",[e._v("_")]),e._v(" 显式设置为一个值将禁用此行为。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> [ 'a', 'b', 'c' ]\n[ 'a', 'b', 'c' ]\n> _.length\n3\n> _ += 1\nExpression assignment to _ now disabled.\n4\n> 1 + 1\n2\n> _\n4\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("p",[e._v("同样，"),n("code",[e._v("_error")]),e._v(" 将引用上次看到的错误，如果有的话。 将 "),n("code",[e._v("_error")]),e._v(" 显式设置为一个值将禁用此行为。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> throw new Error('foo');\nError: foo\n> _error.message\n'foo'\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h5",{attrs:{id:"await-关键词"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#await-关键词"}},[e._v("#")]),e._v(" await 关键词"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#await-keyword",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("With the "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/cli.html#cli_experimental_repl_await",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("--experimental-repl-await")]),n("OutboundLink")],1),e._v(" command line option specified, experimental support for the "),n("code",[e._v("await")]),e._v(" keyword is enabled.")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> await Promise.resolve(123)\n123\n> await Promise.reject(new Error('REPL await'))\nError: REPL await\n    at repl:1:45\n> const timeout = util.promisify(setTimeout);\nundefined\n> const old = Date.now(); await timeout(1000); console.log(Date.now() - old);\n1002\nundefined\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br")])]),n("h4",{attrs:{id:"反向i搜索"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#反向i搜索"}},[e._v("#")]),e._v(" 反向i搜索"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#reverse-i-search",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/reverse_i_search.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v12.17.0")]),e._v(" "),n("p",[e._v("REPL 支持类似于 "),n("a",{attrs:{href:"http://url.nodejs.cn/7UdTEN",target:"_blank",rel:"noopener noreferrer"}},[e._v("ZSH"),n("OutboundLink")],1),e._v(" 的双向反向搜索。")]),e._v(" "),n("p",[e._v("改变方向立即从当前位置开始搜索预期方向的下一个条目。")]),e._v(" "),n("h4",{attrs:{id:"自定义的解释函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义的解释函数"}},[e._v("#")]),e._v(" 自定义的解释函数"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#custom-evaluation-functions",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/custom_evaluation_functions.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("当新建 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 时，可能会提供自定义评价函数。 例如，这可用于实现完全定制的 REPL 应用程序。")]),e._v(" "),n("p",[e._v("以下说明了一个 REPL 的假设示例，该示例执行将文本从一种语言翻译成另一种语言：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\nconst { Translator } = require('translator');\n\nconst myTranslator = new Translator('en', 'fr');\n\nfunction myEval(cmd, context, filename, callback) {\n  callback(null, myTranslator.translate(cmd));\n}\n\nrepl.start({ prompt: '> ', eval: myEval });\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br")])]),n("h5",{attrs:{id:"可恢复的错误"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#可恢复的错误"}},[e._v("#")]),e._v(" 可恢复的错误"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#recoverable-errors",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("As a user is typing input into the REPL prompt, pressing the "),n("code",[e._v("<enter>")]),e._v(" key will send the current line of input to the "),n("code",[e._v("eval")]),e._v(" function. In order to support multi-line input, the eval function can return an instance of "),n("code",[e._v("repl.Recoverable")]),e._v(" to the provided callback function:")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("function myEval(cmd, context, filename, callback) {\n  let result;\n  try {\n    result = vm.runInThisContext(cmd);\n  } catch (e) {\n    if (isRecoverableError(e)) {\n      return callback(new repl.Recoverable(e));\n    }\n  }\n  callback(null, result);\n}\n\nfunction isRecoverableError(error) {\n  if (error.name === 'SyntaxError') {\n    return /^(Unexpected end of input|Unexpected token)/.test(error.message);\n  }\n  return false;\n}\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br")])]),n("h4",{attrs:{id:"自定义-repl-输出"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义-repl-输出"}},[e._v("#")]),e._v(" 自定义 REPL 输出"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#customizing-repl-output",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/customizing_repl_output.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("默认情况下，"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 实例在将输出写入提供的 "),n("code",[e._v("Writable")]),e._v(" 流（默认为 "),n("code",[e._v("process.stdout")]),e._v("）之前使用 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/util.html#util_util_inspect_object_options",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("util.inspect()")]),n("OutboundLink")],1),e._v(" 方法格式化输出。 "),n("code",[e._v("showProxy")]),e._v(" 检查选项默认设置为 true，"),n("code",[e._v("colors")]),e._v(" 选项设置为 true，具体取决于 REPL 的 "),n("code",[e._v("useColors")]),e._v(" 选项。")]),e._v(" "),n("p",[e._v("可以在构造时指定 "),n("code",[e._v("useColors")]),e._v(" 布尔选项，以指示默认编写器使用 ANSI 风格的代码为 "),n("code",[e._v("util.inspect()")]),e._v(" 方法的输出着色。")]),e._v(" "),n("p",[e._v("如果 REPL 作为独立程序运行，也可以通过使用 "),n("code",[e._v("inspect.replDefaults")]),e._v(" 属性（反映了 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/util.html#util_util_inspect_object_options",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("util.inspect()")]),n("OutboundLink")],1),e._v(" 中的 "),n("code",[e._v("defaultOptions")]),e._v("）从 REPL 内部更改 REPL 的"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/util.html#util_util_inspect_object_options",target:"_blank",rel:"noopener noreferrer"}},[e._v("检查默认值"),n("OutboundLink")],1),e._v("。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> util.inspect.replDefaults.compact = false;\nfalse\n> [1]\n[\n  1\n]\n>\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("p",[e._v("要完全自定义 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 实例的输出，则在构建时为 "),n("code",[e._v("writer")]),e._v(" 选项传入新函数。 例如，下面的示例只是将任何输入文本转换为大写：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\n\nconst r = repl.start({ prompt: '> ', eval: myEval, writer: myWriter });\n\nfunction myEval(cmd, context, filename, callback) {\n  callback(null, cmd);\n}\n\nfunction myWriter(output) {\n  return output.toUpperCase();\n}\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h3",{attrs:{id:"replserver-类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#replserver-类"}},[e._v("#")]),e._v(" "),n("code",[e._v("REPLServer")]),e._v(" 类"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#class-replserver",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/class_replserver.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v0.1.91")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("options")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" | "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 参见 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_repl_start_options",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.start()")]),n("OutboundLink")],1)]),e._v(" "),n("li",[e._v("继承自: "),n("a",{attrs:{href:"http://nodejs.cn/api/readline.html#class-readlineinterface",target:"_blank",rel:"noopener noreferrer"}},[e._v("<readline.Interface>"),n("OutboundLink")],1)])]),e._v(" "),n("p",[n("code",[e._v("repl.REPLServer")]),e._v(" 的实例是使用 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_repl_start_options",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.start()")]),n("OutboundLink")],1),e._v(" 方法或直接使用 JavaScript "),n("code",[e._v("new")]),e._v(" 关键字创建的。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\n\nconst options = { useColors: true };\n\nconst firstInstance = repl.start(options);\nconst secondInstance = new repl.REPLServer(options);\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h4",{attrs:{id:"exit-事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#exit-事件"}},[e._v("#")]),e._v(" "),n("code",[e._v("'exit'")]),e._v(" 事件"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#event-exit",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/event_exit.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v0.7.7")]),e._v(" "),n("p",[e._v("不带任何参数调用监听器回调。")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("replServer.on('exit', () => {\n  console.log('Received \"exit\" event from repl!');\n  process.exit();\n});\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h4",{attrs:{id:"reset-事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#reset-事件"}},[e._v("#")]),e._v(" "),n("code",[e._v("'reset'")]),e._v(" 事件"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#event-reset",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/event_reset.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v0.11.0")]),e._v(" "),n("p",[e._v("当重置 REPL 的上下文时会触发 "),n("code",[e._v("'reset'")]),e._v(" 事件。 每当接收到 "),n("code",[e._v(".clear")]),e._v(" 命令作为输入时，就会发生这种情况，除非 REPL 使用默认评估器并且 "),n("code",[e._v("repl.REPLServer")]),e._v(" 实例是在 "),n("code",[e._v("useGlobal")]),e._v(" 选项设置为 "),n("code",[e._v("true")]),e._v(" 的情况下创建的。 将使用对 "),n("code",[e._v("context")]),e._v(" 对象的引用作为唯一参数调用监听器回调。")]),e._v(" "),n("p",[e._v("这可以主要用于将 REPL 上下文重新初始化为一些预定义的状态：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\n\nfunction initializeContext(context) {\n  context.m = 'test';\n}\n\nconst r = repl.start({ prompt: '> ' });\ninitializeContext(r.context);\n\nr.on('reset', initializeContext);\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br")])]),n("p",[e._v("当执行此代码时，可以修改全局 "),n("code",[e._v("'m'")]),e._v(" 变量，然后使用 "),n("code",[e._v(".clear")]),e._v(" 命令将其重置为其初始值：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ ./node example.js\n> m\n'test'\n> m = 1\n1\n> m\n1\n> .clear\nClearing context...\n> m\n'test'\n>\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("h4",{attrs:{id:"replserver-definecommand-keyword-cmd"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#replserver-definecommand-keyword-cmd"}},[e._v("#")]),e._v(" "),n("code",[e._v("replServer.defineCommand(keyword, cmd)")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#replserverdefinecommandkeyword-cmd",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/replserver_definecommand_keyword_cmd.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v0.3.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("keyword")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 命令关键字（不带前导 "),n("code",[e._v(".")]),e._v(" 字符）。")]),e._v(" "),n("li",[n("code",[e._v("cmd")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" | "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1),e._v(" 当处理命令时调用的函数。")])]),e._v(" "),n("p",[n("code",[e._v("replServer.defineCommand()")]),e._v(" 方法用于向 REPL 实例添加新的以 "),n("code",[e._v(".")]),e._v(" 为前缀的命令。 此类命令是通过键入 "),n("code",[e._v(".")]),e._v(" 后跟 "),n("code",[e._v("keyword")]),e._v(" 来调用的。 "),n("code",[e._v("cmd")]),e._v(" 是具有以下属性的 "),n("code",[e._v("Function")]),e._v(" 或 "),n("code",[e._v("Object")]),e._v("：")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("help")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 当输入 "),n("code",[e._v(".help")]),e._v(" 时显示的帮助文本（可选）。")]),e._v(" "),n("li",[n("code",[e._v("action")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1),e._v(" 要执行的函数，可选择接受单个字符串参数。")])]),e._v(" "),n("p",[e._v("以下示例显示了添加到 REPL 实例的两个新命令：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\n\nconst replServer = repl.start({ prompt: '> ' });\nreplServer.defineCommand('sayhello', {\n  help: 'Say hello',\n  action(name) {\n    this.clearBufferedCommand();\n    console.log(`Hello, ${name}!`);\n    this.displayPrompt();\n  }\n});\nreplServer.defineCommand('saybye', function saybye() {\n  console.log('Goodbye!');\n  this.close();\n});\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])]),n("p",[e._v("然后可以在 REPL 实例中使用新命令：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("> .sayhello Node.js User\nHello, Node.js User!\n> .saybye\nGoodbye!\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h4",{attrs:{id:"replserver-displayprompt-preservecursor"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#replserver-displayprompt-preservecursor"}},[e._v("#")]),e._v(" "),n("code",[e._v("replServer.displayPrompt([preserveCursor])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#replserverdisplaypromptpreservecursor",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/replserver_displayprompt_preservecursor.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v0.1.91")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("preserveCursor")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[n("code",[e._v("replServer.displayPrompt()")]),e._v(" 方法准备 REPL 实例以供用户输入，将配置的 "),n("code",[e._v("prompt")]),e._v(" 打印到 "),n("code",[e._v("output")]),e._v(" 中的新行并恢复 "),n("code",[e._v("input")]),e._v(" 以接受新输入。")]),e._v(" "),n("p",[e._v("当输入多行输入时，打印省略号而不是'提示'。")]),e._v(" "),n("p",[e._v("当 "),n("code",[e._v("preserveCursor")]),e._v(" 为 "),n("code",[e._v("true")]),e._v(" 时，光标位置不会重置为 "),n("code",[e._v("0")]),e._v("。")]),e._v(" "),n("p",[n("code",[e._v("replServer.displayPrompt")]),e._v(" 方法主要用于从操作函数内部调用使用 "),n("code",[e._v("replServer.defineCommand()")]),e._v(" 方法注册的命令。")]),e._v(" "),n("h4",{attrs:{id:"replserver-clearbufferedcommand"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#replserver-clearbufferedcommand"}},[e._v("#")]),e._v(" "),n("code",[e._v("replServer.clearBufferedCommand()")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#replserverclearbufferedcommand",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/replserver_clearbufferedcommand.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v9.0.0")]),e._v(" "),n("p",[n("code",[e._v("replServer.clearBufferedCommand()")]),e._v(" 方法清除任何已缓冲但尚未执行的命令。 此方法主要用于从使用 "),n("code",[e._v("replServer.defineCommand()")]),e._v(" 方法注册的命令的操作函数中调用。")]),e._v(" "),n("h4",{attrs:{id:"replserver-parsereplkeyword-keyword-rest"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#replserver-parsereplkeyword-keyword-rest"}},[e._v("#")]),e._v(" "),n("code",[e._v("replServer.parseREPLKeyword(keyword[, rest])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#replserverparsereplkeywordkeyword-rest",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/replserver_parsereplkeyword_keyword_rest.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v0.8.9弃用于: v9.0.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("keyword")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 要解析和执行的潜在关键字")]),e._v(" "),n("li",[n("code",[e._v("rest")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/6sTGdS",target:"_blank",rel:"noopener noreferrer"}},[n("any",[n("OutboundLink")],1)],1),e._v(" 关键字命令的任何参数")]),e._v(" "),n("li",[e._v("返回: "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1)])]),e._v(" "),n("p",[e._v("用于解析和执行 "),n("code",[e._v("REPLServer")]),e._v(" 个关键字的内部方法。 如果 "),n("code",[e._v("keyword")]),e._v(" 是有效关键字，则返回 "),n("code",[e._v("true")]),e._v("，否则返回 "),n("code",[e._v("false")]),e._v("。")]),e._v(" "),n("h4",{attrs:{id:"replserver-setuphistory-historypath-callback"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#replserver-setuphistory-historypath-callback"}},[e._v("#")]),e._v(" "),n("code",[e._v("replServer.setupHistory(historyPath, callback)")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#replserversetuphistoryhistorypath-callback",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/replserver_setuphistory_historypath_callback.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("新增于: v11.10.0")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("historyPath")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 历史文件的路径")]),e._v(" "),n("li",[n("code",[e._v("callback")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1),e._v(" 当历史写入准备好或出错时调用\n"),n("ul",[n("li",[n("code",[e._v("err")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/qZ873x",target:"_blank",rel:"noopener noreferrer"}},[n("Error",[n("OutboundLink")],1)],1)]),e._v(" "),n("li",[n("code",[e._v("repl")]),e._v(" "),n("a",{attrs:{href:"http://nodejs.cn/api/repl.html#class-replserver",target:"_blank",rel:"noopener noreferrer"}},[e._v("<repl.REPLServer>"),n("OutboundLink")],1)])])])]),e._v(" "),n("p",[e._v("初始化 REPL 实例的历史日志文件。")]),e._v(" "),n("p",[e._v("但是，以编程方式创建 REPL 时并非如此。 在以编程方式使用 REPL 实例时，使用此方法初始化历史日志文件。")]),e._v(" "),n("h3",{attrs:{id:"repl-start-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#repl-start-options"}},[e._v("#")]),e._v(" "),n("code",[e._v("repl.start([options])")]),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#replstartoptions",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/repl_start_options.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("ul",[n("li",[n("code",[e._v("options")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jzn6Ao",target:"_blank",rel:"noopener noreferrer"}},[n("Object",[n("OutboundLink")],1)],1),e._v(" | "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" "),n("ul",[n("li",[n("code",[e._v("prompt")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/9Tw2bK",target:"_blank",rel:"noopener noreferrer"}},[n("string",[n("OutboundLink")],1)],1),e._v(" 要显示的输入提示。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("'> '")]),e._v(" （带有尾随空格）。")]),e._v(" "),n("li",[n("code",[e._v("input")]),e._v(" "),n("a",{attrs:{href:"http://nodejs.cn/api/stream.html#class-streamreadable",target:"_blank",rel:"noopener noreferrer"}},[e._v("<stream.Readable>"),n("OutboundLink")],1),e._v(" 将从中读取 REPL 输入的 "),n("code",[e._v("Readable")]),e._v(" 流。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("process.stdin")]),e._v("。")]),e._v(" "),n("li",[n("code",[e._v("output")]),e._v(" "),n("a",{attrs:{href:"http://nodejs.cn/api/stream.html#class-streamwritable",target:"_blank",rel:"noopener noreferrer"}},[e._v("<stream.Writable>"),n("OutboundLink")],1),e._v(" REPL 输出将写入的 "),n("code",[e._v("Writable")]),e._v(" 流。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("process.stdout")]),e._v("。")]),e._v(" "),n("li",[n("code",[e._v("terminal")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1),e._v(" 如果 "),n("code",[e._v("true")]),e._v("，则指定 "),n("code",[e._v("output")]),e._v(" 应被视为 TTY 终端。 "),n("strong",[e._v("默认:")]),e._v(" 在实例化时检查 "),n("code",[e._v("output")]),e._v(" 流上 "),n("code",[e._v("isTTY")]),e._v(" 属性的值。")]),e._v(" "),n("li",[n("code",[e._v("eval")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1),e._v(" 当评估每一给定输入行时要使用的函数。 "),n("strong",[e._v("默认:")]),e._v(" JavaScript "),n("code",[e._v("eval()")]),e._v(" 函数的异步封装器。 "),n("code",[e._v("eval")]),e._v(" 函数可能会出现 "),n("code",[e._v("repl.Recoverable")]),e._v(" 错误，表明输入不完整并提示输入额外的行。")]),e._v(" "),n("li",[n("code",[e._v("useColors")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1),e._v(" 如果为 "),n("code",[e._v("true")]),e._v("，则指定默认的 "),n("code",[e._v("writer")]),e._v(" 函数应在 REPL 输出中包含 ANSI 颜色样式。 如果提供了自定义 "),n("code",[e._v("writer")]),e._v(" 函数，则此功能无效。 "),n("strong",[e._v("默认:")]),e._v(" 如果 REPL 实例的 "),n("code",[e._v("terminal")]),e._v(" 值为 "),n("code",[e._v("true")]),e._v("，则检查 "),n("code",[e._v("output")]),e._v(" 流上的颜色支持。")]),e._v(" "),n("li",[n("code",[e._v("useGlobal")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1),e._v(" 如果为 "),n("code",[e._v("true")]),e._v("，则指定默认评估函数将使用 JavaScript "),n("code",[e._v("global")]),e._v(" 作为上下文，而不是为 REPL 实例创建新的单独上下文。 node CLI REPL 将此值设置为 "),n("code",[e._v("true")]),e._v("。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("false")]),e._v("。")]),e._v(" "),n("li",[n("code",[e._v("ignoreUndefined")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1),e._v(" 如果为 "),n("code",[e._v("true")]),e._v("，则指定默认编写器在计算结果为 "),n("code",[e._v("undefined")]),e._v(" 时不会输出命令的返回值。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("false")]),e._v("。")]),e._v(" "),n("li",[n("code",[e._v("writer")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1),e._v(" 在写入 "),n("code",[e._v("output")]),e._v(" 之前调用以格式化每个命令的输出的函数。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/util.html#util_util_inspect_object_options",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("util.inspect()")]),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("li",[n("code",[e._v("completer")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/ceTQa6",target:"_blank",rel:"noopener noreferrer"}},[n("Function",[n("OutboundLink")],1)],1),e._v(" 用于自定义 Tab 自动完成的可选函数。 有关示例，请参见 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/readline.html#readline_use_of_the_completer_function",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("readline.InterfaceCompleter")]),n("OutboundLink")],1),e._v("。")]),e._v(" "),n("li",[n("code",[e._v("replMode")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/i5E1UH",target:"_blank",rel:"noopener noreferrer"}},[n("symbol",[n("OutboundLink")],1)]),e._v(" 指定默认求值器是在严格模式还是默认（宽松）模式下执行所有 JavaScript 命令的标志。 可接受的值是：\n"),n("ul",[n("li",[n("code",[e._v("repl.REPL_MODE_SLOPPY")]),e._v(" 在宽松模式下计算表达式。")]),e._v(" "),n("li",[n("code",[e._v("repl.REPL_MODE_STRICT")]),e._v(" 在严格模式下计算表达式。 这相当于在每个 repl 语句前面加上 "),n("code",[e._v("'use strict'")]),e._v("。")])])]),e._v(" "),n("li",[n("code",[e._v("breakEvalOnSigint")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1),e._v(" 这不能与自定义 "),n("code",[e._v("eval")]),e._v(" 函数一起使用。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("false")]),e._v("。")]),e._v(" "),n("li",[n("code",[e._v("preview")]),e._v(" "),n("a",{attrs:{href:"http://url.nodejs.cn/jFbvuT",target:"_blank",rel:"noopener noreferrer"}},[n("boolean",[n("OutboundLink")],1)],1),e._v(" 定义 repl 是否打印自动完成和输出预览。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("true")]),e._v(" 使用默认 eval 函数和 "),n("code",[e._v("false")]),e._v("，以防使用自定义 eval 函数。 如果 "),n("code",[e._v("terminal")]),e._v(" 为假，则没有预览，"),n("code",[e._v("preview")]),e._v(" 的值没有影响。")])])]),e._v(" "),n("li",[e._v("返回: "),n("a",{attrs:{href:"http://nodejs.cn/api/repl.html#class-replserver",target:"_blank",rel:"noopener noreferrer"}},[e._v("<repl.REPLServer>"),n("OutboundLink")],1)])]),e._v(" "),n("p",[n("code",[e._v("repl.start()")]),e._v(" 方法创建并启动了一个 "),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#repl_class_replserver",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("repl.REPLServer")]),n("OutboundLink")],1),e._v(" 实例。")]),e._v(" "),n("p",[e._v("如果 "),n("code",[e._v("options")]),e._v(" 是字符串，则指定输入提示：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const repl = require('repl');\n\n// Unix 风格的提示\nrepl.start('$ ');\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])]),n("h3",{attrs:{id:"node-js-的-repl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js-的-repl"}},[e._v("#")]),e._v(" Node.js 的 REPL"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#the-nodejs-repl",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/the_node_js_repl.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("Node.js 本身使用 "),n("code",[e._v("repl")]),e._v(" 模块来提供自己的交互界面来执行 JavaScript。 这可以通过执行 Node.js 二进制文件而不传入任何参数（或通过传入 "),n("code",[e._v("-i")]),e._v(" 参数）来使用：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ node\n> const a = [1, 2, 3];\nundefined\n> a\n[ 1, 2, 3 ]\n> a.forEach((v) => {\n...   console.log(v);\n...   });\n1\n2\n3\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("h4",{attrs:{id:"环境变量选项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#环境变量选项"}},[e._v("#")]),e._v(" 环境变量选项"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#environment-variable-options",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/environment_variable_options.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("可以使用以下环境变量自定义 Node.js REPL 的各种行为：")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("NODE_REPL_HISTORY")]),e._v(": 当给出有效路径时，持久的 REPL 历史记录将保存到用户主目录中的指定文件而不是 "),n("code",[e._v(".node_repl_history")]),e._v("。 将此值设置为 "),n("code",[e._v("''")]),e._v("（空字符串）将禁用持久的 REPL 历史记录。 将从值中删除空格。 在 Windows 平台上，具有空值的环境变量无效，因此将此变量设置为一个或多个空格以禁用持久的 REPL 历史记录。")]),e._v(" "),n("li",[n("code",[e._v("NODE_REPL_HISTORY_SIZE")]),e._v(": 如果历史记录可用，则控制将保留多少行历史记录。 必须是正数。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("1000")]),e._v("。")]),e._v(" "),n("li",[n("code",[e._v("NODE_REPL_MODE")]),e._v(": 可能是 "),n("code",[e._v("'sloppy'")]),e._v(" 或 "),n("code",[e._v("'strict'")]),e._v("。 "),n("strong",[e._v("默认值:")]),e._v(" "),n("code",[e._v("'sloppy'")]),e._v("，这将允许运行非严格模式的代码。")])]),e._v(" "),n("h4",{attrs:{id:"历史记录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#历史记录"}},[e._v("#")]),e._v(" 历史记录"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#persistent-history",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/persistent_history.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("默认情况下，Node.js REPL 将通过将输入保存到位于用户主目录中的 "),n("code",[e._v(".node_repl_history")]),e._v(" 文件来保留 "),n("code",[e._v("node")]),e._v(" REPL 会话之间的历史记录。 这可以通过设置环境变量 "),n("code",[e._v("NODE_REPL_HISTORY=''")]),e._v(" 来禁用。")]),e._v(" "),n("h4",{attrs:{id:"在高级的行编辑器中使用-node-js-repl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在高级的行编辑器中使用-node-js-repl"}},[e._v("#")]),e._v(" 在高级的行编辑器中使用 Node.js REPL"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#using-the-nodejs-repl-with-advanced-line-editors",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/using_the_node_js_repl_with_advanced_line_editors.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("对于高级行编辑器，使用环境变量 "),n("code",[e._v("NODE_NO_READLINE=1")]),e._v(" 启动 Node.js。 这将在规范的终端设置中启动主程序和调试器 REPL，这将允许与 "),n("code",[e._v("rlwrap")]),e._v(" 一起使用。")]),e._v(" "),n("p",[e._v("例如，可以将以下内容添加到 "),n("code",[e._v(".bashrc")]),e._v(" 文件中：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('alias node="env NODE_NO_READLINE=1 rlwrap node"\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("h4",{attrs:{id:"在一个-node-js-实例中启动多个-repl-实例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在一个-node-js-实例中启动多个-repl-实例"}},[e._v("#")]),e._v(" 在一个 Node.js 实例中启动多个 REPL 实例"),n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl.html#starting-multiple-repl-instances-against-a-single-running-instance",target:"_blank",rel:"noopener noreferrer"}},[e._v("#"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api-v12/repl/starting_multiple_repl_instances_against_a_single_running_instance.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("中英对照"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("可以针对共享单个 "),n("code",[e._v("global")]),e._v(" 对象但具有单独 I/O 接口的单个运行 Node.js 实例创建和运行多个 REPL 实例。")]),e._v(" "),n("p",[e._v("例如，以下示例在 "),n("code",[e._v("stdin")]),e._v("、Unix 套接字和 TCP 套接字上提供单独的 REPL：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const net = require('net');\nconst repl = require('repl');\nlet connections = 0;\n\nrepl.start({\n  prompt: 'Node.js via stdin> ',\n  input: process.stdin,\n  output: process.stdout\n});\n\nnet.createServer((socket) => {\n  connections += 1;\n  repl.start({\n    prompt: 'Node.js via Unix socket> ',\n    input: socket,\n    output: socket\n  }).on('exit', () => {\n    socket.end();\n  });\n}).listen('/tmp/node-repl-sock');\n\nnet.createServer((socket) => {\n  connections += 1;\n  repl.start({\n    prompt: 'Node.js via TCP socket> ',\n    input: socket,\n    output: socket\n  }).on('exit', () => {\n    socket.end();\n  });\n}).listen(5001);\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br")])]),n("p",[e._v("从命令行运行此应用程序将在标准输入上启动 REPL。 其他 REPL 客户端可以通过 Unix 套接字或 TCP 套接字连接。 例如，"),n("code",[e._v("telnet")]),e._v(" 可用于连接 TCP 套接字，而 "),n("code",[e._v("socat")]),e._v(" 可用于连接 Unix 和 TCP 套接字。")]),e._v(" "),n("p",[e._v("通过从基于 Unix 套接字的服务器而不是标准输入启动 REPL，可以连接到长时间运行的 Node.js 进程而无需重新启动它。")]),e._v(" "),n("p",[e._v("有关在 "),n("code",[e._v("net.Server")]),e._v(" 和 "),n("code",[e._v("net.Socket")]),e._v(' 实例上运行 "全功能" ('),n("code",[e._v("terminal")]),e._v(") REPL 的示例，请参阅："),n("a",{attrs:{href:"https://gist.github.com/TooTallNate/2209310",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://gist.github.com/TooTallNate/2209310"),n("OutboundLink")],1),e._v("。")]),e._v(" "),n("p",[e._v("关于在 "),n("a",{attrs:{href:"http://url.nodejs.cn/oJ3NGb",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("curl(1)")]),n("OutboundLink")],1),e._v(" 上运行 REPL 实例的示例，请参阅："),n("a",{attrs:{href:"https://gist.github.com/TooTallNate/2053342",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://gist.github.com/TooTallNate/2053342"),n("OutboundLink")],1),e._v("。")])])}),[],!1,null,null,null);r.default=a.exports}}]);