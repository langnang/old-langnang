<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JSON to INI</title>
  <link href="https://fonts.font.im/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i"
    rel="stylesheet" />
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="shortcut icon" href="./../favicon.ico" type="image/x-icon" />
  <style type="text/css">
  </style>
</head>

<body>
  <div class="container-fluid" id="app">
    <div class="row">
      <div class="col-md-12 text-center">
        <h2 class="">
          <button type="button" id="to" class="btn btn-primary btn-lg" style="margin:0 auto;"> JSON to INI</button>
        </h2>
      </div>
      <div class="col-md-6">
        <textarea id="file_input" class="form-control" rows="30">
        </textarea>
      </div>
      <div class="col-md-6">
        <textarea id="file_output" class="form-control" rows="30" readonly></textarea>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@langnang/js/lib/ln.js"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      const json2ini = (json) => {
        return Object.keys(json).reduce((total, key) => {
          if (ln.typeOf(json[key]) == 'string') {
            total = `${key}=${json[key]}\n` + total;
          } else {
            total += `[${key}]\n` + Object.keys(json[key]).reduce((subTotal, subKey) => {
              subTotal = `${subKey}=${json[key][subKey]}\n` + subTotal;
              return subTotal;
            }, '');
          }
          return total;
        }, "");
      }
      $("#to").click(function () {
        let json = $("#file_input").val();
        if (!ln.isJSONString(json)) {
          return;
        }
        json = JSON.parse(json);
        let ini = json2ini(json);
        // console.log(json);
        $("#file_output").val(ini);
      })
    })
  </script>
</body>

</html>
